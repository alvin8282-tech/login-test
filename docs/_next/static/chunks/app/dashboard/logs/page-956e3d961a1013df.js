(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[181],{690:(e,s,t)=>{Promise.resolve().then(t.bind(t,4681))},4681:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>c});var l=t(5155),a=t(2115),r=t(858);function i(e){let{logs:s,onExport:t}=e,[r,i]=(0,a.useState)("loginTime"),[d,n]=(0,a.useState)("desc"),[c,o]=(0,a.useState)(1),x=e=>{r===e?n("asc"===d?"desc":"asc"):(i(e),n("desc"))},m=[...s].sort((e,s)=>{let t=e[r],l=s[r];if("string"==typeof t&&"string"==typeof l){let e=t.localeCompare(l);return"asc"===d?e:-e}return"number"==typeof t&&"number"==typeof l?"asc"===d?t-l:l-t:0}),h=Math.ceil(m.length/20),u=(c-1)*20,p=u+20,j=m.slice(u,p),g=e=>new Date(e).toLocaleString("ko-KR",{year:"2-digit",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),v=e=>r!==e?(0,l.jsx)("svg",{className:"w-4 h-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})}):"asc"===d?(0,l.jsx)("svg",{className:"w-4 h-4 text-[#0066CC]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4h13M3 8h9m-9 4h6m4 0l4-4m0 0l4 4m-4-4v12"})}):(0,l.jsx)("svg",{className:"w-4 h-4 text-[#0066CC]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4h13M3 8h9m-9 4h9m5-4v12m0 0l-4-4m4 4l4-4"})});return(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[(0,l.jsx)("div",{className:"p-6 border-b border-slate-200",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-slate-900",children:"접속 로그"}),(0,l.jsxs)("p",{className:"text-sm text-slate-600 mt-1",children:["총 ",s.length,"개의 접속 기록"]})]}),(0,l.jsxs)("button",{onClick:t,className:"flex items-center px-4 py-2 bg-[#0066CC] text-white rounded-lg hover:bg-[#003876] transition-colors",children:[(0,l.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"CSV 내보내기"]})]})}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full",children:[(0,l.jsx)("thead",{className:"bg-slate-50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider cursor-pointer hover:bg-slate-100",onClick:()=>x("userName"),children:(0,l.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,l.jsx)("span",{children:"사용자명"}),v("userName")]})}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider cursor-pointer hover:bg-slate-100",onClick:()=>x("loginTime"),children:(0,l.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,l.jsx)("span",{children:"접속일시"}),v("loginTime")]})}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider cursor-pointer hover:bg-slate-100",onClick:()=>x("logoutTime"),children:(0,l.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,l.jsx)("span",{children:"로그아웃일시"}),v("logoutTime")]})}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider cursor-pointer hover:bg-slate-100",onClick:()=>x("ipAddress"),children:(0,l.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,l.jsx)("span",{children:"접속 IP"}),v("ipAddress")]})}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider cursor-pointer hover:bg-slate-100",onClick:()=>x("browserInfo"),children:(0,l.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,l.jsx)("span",{children:"브라우저"}),v("browserInfo")]})}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider cursor-pointer hover:bg-slate-100",onClick:()=>x("status"),children:(0,l.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,l.jsx)("span",{children:"상태"}),v("status")]})}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider cursor-pointer hover:bg-slate-100",onClick:()=>x("sessionDuration"),children:(0,l.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,l.jsx)("span",{children:"세션 시간"}),v("sessionDuration")]})}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"세부정보"})]})}),(0,l.jsx)("tbody",{className:"bg-white divide-y divide-slate-200",children:j.map(e=>{var s;return(0,l.jsxs)("tr",{className:"hover:bg-slate-50",children:[(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-[#003876] to-[#0066CC] rounded-full flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-white font-medium text-xs",children:e.userName.charAt(0)})}),(0,l.jsxs)("div",{className:"ml-3",children:[(0,l.jsx)("div",{className:"text-sm font-medium text-slate-900",children:e.userName}),(0,l.jsx)("div",{className:"text-xs text-slate-500",children:e.email})]})]})}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-900",children:g(e.loginTime)}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-900",children:e.logoutTime?g(e.logoutTime):"-"}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-900",children:e.ipAddress}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,l.jsx)("div",{className:"flex items-center",children:(0,l.jsx)("span",{className:"text-sm text-slate-900",children:e.browserInfo})})}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(s=e.status,(0,l.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat({active:"bg-green-100 text-green-800",success:"bg-green-100 text-green-800",logged_out:"bg-blue-100 text-blue-800",failed:"bg-red-100 text-red-800"}[s]),children:{active:"접속 중",success:"성공",logged_out:"로그아웃",failed:"실패"}[s]}))}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-900",children:(e=>{if(!e)return"-";let s=Math.floor(e/3600),t=Math.floor(e%3600/60);return s>0?"".concat(s,"시간 ").concat(t,"분"):"".concat(t,"분")})(e.sessionDuration)}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsxs)("div",{className:"text-xs text-slate-500",children:["방법: ","otp"===e.loginMethod?"OTP":"비밀번호"]}),e.failureReason&&(0,l.jsxs)("div",{className:"text-xs text-red-600",children:["실패: ",e.failureReason]})]})})]},e.id)})})]})}),h>1&&(0,l.jsx)("div",{className:"px-6 py-3 border-t border-slate-200",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"text-sm text-slate-700",children:[u+1,"-",Math.min(p,m.length)," / ",m.length]}),(0,l.jsxs)("div",{className:"flex space-x-2",children:[(0,l.jsx)("button",{onClick:()=>o(c-1),disabled:1===c,className:"px-3 py-1 border border-slate-300 rounded-md text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-50",children:"이전"}),(()=>{let e=[],s=Math.max(1,c-Math.floor(2.5)),t=Math.min(h,s+5-1);t-s+1<5&&(s=Math.max(1,t-5+1));for(let a=s;a<=t;a++)e.push((0,l.jsx)("button",{onClick:()=>o(a),className:"px-3 py-1 border rounded-md text-sm ".concat(c===a?"bg-[#0066CC] text-white border-[#0066CC]":"border-slate-300 hover:bg-slate-50"),children:a},a));return e})(),(0,l.jsx)("button",{onClick:()=>o(c+1),disabled:c===h,className:"px-3 py-1 border border-slate-300 rounded-md text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-50",children:"다음"})]})]})})]})}var d=t(3333),n=t(1337);function c(){let[e,s]=(0,a.useState)([]),[t,c]=(0,a.useState)([]),[o,x]=(0,a.useState)({totalSessions:0,activeSessions:0,failedAttempts:0,avgSessionDuration:0,uniqueUsers:0}),[m,h]=(0,a.useState)([]),[u,p]=(0,a.useState)(!0),[j,g]=(0,a.useState)({startDate:"",endDate:"",userId:"",status:"all"}),[v,f]=(0,a.useState)([]);(0,a.useEffect)(()=>{b()},[]),(0,a.useEffect)(()=>{N()},[e,j]);let b=async()=>{p(!0);try{(0,d.w0)();let e=(0,d.Rd)(),t=(0,n.CF)(),l=(0,d.EF)();s(e),f(t),h(l),x((0,d.qk)(e));let a=new Date,r=new Date;r.setDate(r.getDate()-7),g(e=>({...e,startDate:r.toISOString().split("T")[0],endDate:a.toISOString().split("T")[0]}))}catch(e){console.error("데이터 로드 실패:",e)}finally{p(!1)}},N=()=>{let s=[...e];j.startDate&&j.endDate&&(s=(0,d.IM)(j.startDate,j.endDate)),j.userId&&(s=s.filter(e=>e.userId===j.userId)),"all"!==j.status&&("success"===j.status?s=s.filter(e=>"active"===e.status||"logged_out"===e.status):"failed"===j.status?s=s.filter(e=>"failed"===e.status):"active"===j.status&&(s=s.filter(e=>"active"===e.status))),c(s)},w=(e,s)=>{g(t=>({...t,[e]:s}))};return u?(0,l.jsx)(r.A,{children:(0,l.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"w-16 h-16 border-4 border-[#0066CC] border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-slate-600",children:"접속 로그를 불러오는 중..."})]})})}):(0,l.jsx)(r.A,{children:(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-[#003876]",children:"접속 로그"}),(0,l.jsx)("p",{className:"text-slate-600 mt-1",children:"사용자 접속 기록 및 보안 로그를 관리합니다"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[(0,l.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-4",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,l.jsx)("svg",{className:"w-5 h-5 text-[#0066CC]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),(0,l.jsxs)("div",{className:"ml-3",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"총 세션"}),(0,l.jsx)("p",{className:"text-xl font-bold text-slate-900",children:o.totalSessions})]})]})}),(0,l.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-4",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,l.jsx)("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),(0,l.jsxs)("div",{className:"ml-3",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"활성 세션"}),(0,l.jsx)("p",{className:"text-xl font-bold text-slate-900",children:m.length})]})]})}),(0,l.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-4",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"p-2 bg-red-100 rounded-lg",children:(0,l.jsx)("svg",{className:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.732 15.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,l.jsxs)("div",{className:"ml-3",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"실패 시도"}),(0,l.jsx)("p",{className:"text-xl font-bold text-slate-900",children:o.failedAttempts})]})]})}),(0,l.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-4",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,l.jsx)("svg",{className:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,l.jsxs)("div",{className:"ml-3",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"평균 세션"}),(0,l.jsxs)("p",{className:"text-xl font-bold text-slate-900",children:[Math.round(o.avgSessionDuration/60),"분"]})]})]})}),(0,l.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-4",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"p-2 bg-orange-100 rounded-lg",children:(0,l.jsx)("svg",{className:"w-5 h-5 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),(0,l.jsxs)("div",{className:"ml-3",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"고유 사용자"}),(0,l.jsx)("p",{className:"text-xl font-bold text-slate-900",children:o.uniqueUsers})]})]})})]}),(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[(0,l.jsx)("div",{className:"p-6 border-b border-slate-200",children:(0,l.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"필터 및 검색"})}),(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"시작 날짜"}),(0,l.jsx)("input",{type:"date",value:j.startDate,onChange:e=>w("startDate",e.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-[#0066CC] focus:border-transparent"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"종료 날짜"}),(0,l.jsx)("input",{type:"date",value:j.endDate,onChange:e=>w("endDate",e.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-[#0066CC] focus:border-transparent"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"사용자"}),(0,l.jsxs)("select",{value:j.userId,onChange:e=>w("userId",e.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-[#0066CC] focus:border-transparent",children:[(0,l.jsx)("option",{value:"",children:"모든 사용자"}),v.map(e=>(0,l.jsx)("option",{value:e.id,children:e.fullName},e.id))]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"상태"}),(0,l.jsxs)("select",{value:j.status,onChange:e=>w("status",e.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-[#0066CC] focus:border-transparent",children:[(0,l.jsx)("option",{value:"all",children:"모든 상태"}),(0,l.jsx)("option",{value:"success",children:"성공"}),(0,l.jsx)("option",{value:"failed",children:"실패"}),(0,l.jsx)("option",{value:"active",children:"활성"})]})]})]}),(0,l.jsxs)("div",{className:"mt-4 flex flex-wrap gap-3",children:[(0,l.jsx)("button",{onClick:()=>{let e=new Date,s=new Date;s.setDate(s.getDate()-7),g({startDate:s.toISOString().split("T")[0],endDate:e.toISOString().split("T")[0],userId:"",status:"all"})},className:"px-4 py-2 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors",children:"필터 초기화"}),(0,l.jsx)("button",{onClick:()=>{(0,d.Bf)(e,"access_logs_all")},className:"px-4 py-2 bg-slate-600 text-white rounded-lg hover:bg-slate-700 transition-colors",children:"전체 로그 내보내기"}),(0,l.jsxs)("div",{className:"text-sm text-slate-600 flex items-center",children:["필터링된 결과: ",t.length,"개 / 전체: ",e.length,"개"]})]})]})]}),m.length>0&&(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[(0,l.jsxs)("div",{className:"p-6 border-b border-slate-200",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"실시간 접속자 현황"}),(0,l.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:"현재 시스템에 접속 중인 사용자들"})]}),(0,l.jsx)("div",{className:"p-6",children:(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:m.map(e=>(0,l.jsx)("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-[#003876] to-[#0066CC] rounded-full flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-white font-medium text-sm",children:e.userName.charAt(0)})}),(0,l.jsxs)("div",{className:"ml-3 flex-1",children:[(0,l.jsx)("div",{className:"text-sm font-medium text-slate-900",children:e.userName}),(0,l.jsx)("div",{className:"text-xs text-slate-500",children:e.ipAddress}),(0,l.jsxs)("div",{className:"text-xs text-green-600",children:["접속: ",new Date(e.loginTime).toLocaleTimeString("ko-KR")]})]}),(0,l.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"})]})},e.id))})})]}),(0,l.jsx)(i,{logs:t,onExport:()=>{(0,d.Bf)(t,"access_logs_filtered")}})]})})}}},e=>{e.O(0,[874,477,441,964,358],()=>e(e.s=690)),_N_E=e.O()}]);
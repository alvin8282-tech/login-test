(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[156],{2056:(e,t,r)=>{"use strict";r.d(t,{$c:()=>l,Gs:()=>o,Kk:()=>c});let s="hyundai_users",l=e=>{let t=a();t.push(e),localStorage.setItem(s,JSON.stringify(t))},a=()=>{let e=localStorage.getItem(s);return e?JSON.parse(e):[]},o=e=>a().find(t=>t.email===e)||null,c=(e,t)=>{let r=a(),l=r.findIndex(t=>t.email===e);-1!==l&&(r[l].otpSecret=t,localStorage.setItem(s,JSON.stringify(r)))}},3741:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var s=r(5155);function l(e){let{variant:t="primary",size:r="md",isLoading:l=!1,children:a,className:o="",disabled:c,...n}=e;return(0,s.jsx)("button",{className:"".concat("font-medium rounded-lg transition-all duration-200 flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-offset-2"," ").concat({primary:"bg-gradient-to-r from-[#003876] to-[#0066CC] text-white hover:from-[#002952] hover:to-[#0052a3] focus:ring-[#0066CC] shadow-md hover:shadow-lg",secondary:"bg-slate-100 text-slate-700 hover:bg-slate-200 focus:ring-slate-500",outline:"border-2 border-[#0066CC] text-[#0066CC] hover:bg-[#0066CC] hover:text-white focus:ring-[#0066CC]"}[t]," ").concat({sm:"px-3 py-2 text-sm",md:"px-4 py-3 text-base",lg:"px-6 py-4 text-lg"}[r]," ").concat(c||l?"opacity-50 cursor-not-allowed":""," ").concat(o),disabled:c||l,...n,children:l?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"처리 중..."]}):a})}r(2115)},3915:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var s=r(5155);function l(e){let{label:t,error:r,className:l="",...a}=e;return(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:t}),(0,s.jsx)("input",{className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-[#0066CC] focus:border-[#0066CC] transition-colors placeholder-slate-400 ".concat(r?"border-red-500 focus:ring-red-500 focus:border-red-500":""," ").concat(l),...a}),r&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:r})]})}r(2115)},8454:(e,t,r)=>{Promise.resolve().then(r.bind(r,8910))},8910:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m});var s=r(5155),l=r(2115),a=r(5695),o=r(1898),c=r(3741),n=r(3915),i=r(2056),d=r(9400);function u(){let e=(0,a.useRouter)(),t=(0,a.useSearchParams)().get("email"),[r,u]=(0,l.useState)(""),[m,h]=(0,l.useState)(""),[x,g]=(0,l.useState)(""),[f,p]=(0,l.useState)(!1),[b,j]=(0,l.useState)(null),[y,v]=(0,l.useState)(""),C=async e=>{try{let r=(0,d.Kj)(t,e),s=await (0,d.Ck)(r);u(s)}catch(e){console.error("QR 코드 생성 실패:",e)}};(0,l.useEffect)(()=>{if(!t)return void e.push("/");let r=(0,i.Gs)(t);if(!r)return void e.push("/");j(r),r.otpSecret&&(C(r.otpSecret),v(r.otpSecret))},[t,e]);let N=async()=>{if(!m.trim())return void g("OTP 코드를 입력해주세요.");if(!/^\d{6}$/.test(m))return void g("OTP는 6자리 숫자여야 합니다.");p(!0),g("");try{(0,d.KV)(m,y)?((0,i.Kk)(t,y),e.push("/login")):g("OTP 코드가 올바르지 않습니다. Google Authenticator에서 생성된 코드를 확인해주세요.")}catch(e){console.error("OTP 검증 실패:",e),g("OTP 검증 중 오류가 발생했습니다.")}finally{p(!1)}};return b?(0,s.jsx)(o.b8,{title:"Google OTP 설정",subtitle:"2단계 인증을 위한 Google OTP를 설정하세요",children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("h3",{className:"font-medium text-slate-700 mb-3",children:[b.fullName,"님의 OTP 설정"]}),r&&(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("p",{className:"text-sm text-slate-600 mb-3",children:"Google Authenticator 앱에서 아래 QR 코드를 스캔하세요:"}),(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)("img",{src:r,alt:"Google OTP QR Code",className:"border rounded-lg",style:{width:"200px",height:"200px"}})})]}),(0,s.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4 mb-4",children:[(0,s.jsx)("h4",{className:"font-medium text-blue-800 mb-2",children:"설정 단계:"}),(0,s.jsxs)("ol",{className:"text-sm text-blue-700 text-left space-y-1",children:[(0,s.jsx)("li",{children:"1. Google Authenticator 앱을 설치하세요"}),(0,s.jsx)("li",{children:"2. 앱에서 '+' 버튼을 눌러 계정 추가"}),(0,s.jsx)("li",{children:"3. 'QR 코드 스캔'을 선택하고 위 코드를 스캔"}),(0,s.jsx)("li",{children:"4. 앱에서 생성된 6자리 코드를 아래에 입력"})]})]})]}),(0,s.jsx)(n.A,{label:"Google OTP 코드",name:"otp",type:"text",placeholder:"6자리 OTP 코드를 입력하세요",value:m,onChange:e=>{h(e.target.value),x&&g("")},error:x,maxLength:6,pattern:"\\d{6}",autoComplete:"one-time-code"}),(0,s.jsx)(c.A,{onClick:N,variant:"primary",size:"lg",className:"w-full",isLoading:f,children:"OTP 설정 완료"}),(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)("button",{type:"button",onClick:()=>e.push("/login"),className:"text-slate-500 hover:text-[#0066CC] text-sm transition-colors",children:"나중에 설정하기"})})]})}):null}function m(){return(0,s.jsx)(l.Suspense,{fallback:(0,s.jsx)("div",{children:"Loading..."}),children:(0,s.jsx)(u,{})})}},9400:(e,t,r)=>{"use strict";r.d(t,{Ck:()=>c,KV:()=>n,Kj:()=>o,lz:()=>a});var s=r(8336),l=r(6862);let a=()=>s.authenticator.generateSecret(),o=(e,t)=>s.authenticator.keyuri(e,"현대오토에버",t),c=async e=>{try{return await l.toDataURL(e)}catch(e){throw console.error("QR 코드 생성 실패:",e),e}},n=(e,t)=>{try{return s.authenticator.verify({token:e,secret:t})}catch(e){return console.error("OTP 검증 실패:",e),!1}}}},e=>{e.O(0,[268,874,486,898,441,964,358],()=>e(e.s=8454)),_N_E=e.O()}]);